(function(t){function e(e){for(var s,i,r=e[0],l=e[1],c=e[2],u=0,m=[];u<r.length;u++)i=r[u],n[i]&&m.push(n[i][0]),n[i]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);d&&d(e);while(m.length)m.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],s=!0,r=1;r<a.length;r++){var l=a[r];0!==n[l]&&(s=!1)}s&&(o.splice(e--,1),t=i(i.s=a[0]))}return t}var s={},n={app:0},o=[];function i(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=s,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(a,s,function(e){return t[e]}.bind(null,s));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var d=l;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var s=a("64a9"),n=a.n(s);n.a},"041d":function(t,e,a){"use strict";var s=a("3605"),n=a.n(s);n.a},"100f":function(t,e,a){"use strict";var s=a("7013"),n=a.n(s);n.a},"20a8":function(t,e,a){"use strict";var s=a("bd3b"),n=a.n(s);n.a},"2b56":function(t,e,a){"use strict";var s=a("31f8"),n=a.n(s);n.a},"31f8":function(t,e,a){},3605:function(t,e,a){},4678:function(t,e,a){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(t){var e=o(t);return a(e)}function o(t){var e=s[t];if(!(e+1)){var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}return e}n.keys=function(){return Object.keys(s)},n.resolve=o,t.exports=n,n.id="4678"},"49cd":function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var s=a("2b0e"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{attrs:{id:"nav"}},[a("router-link",{attrs:{to:"/"}},[t._v("Home")]),t._v(" |\n    "),t.jwt?t._e():a("router-link",{attrs:{to:"/login"}},[t._v("Login")]),t.jwt?a("router-link",{attrs:{to:"/createroute"}},[t._v("Create a route")]):t._e(),t._v(" |\n       "),t.jwt?a("router-link",{attrs:{to:"/dashboard"}},[t._v("My Dashboard")]):t._e(),t._v(" |\n          "),t.jwt?a("router-link",{attrs:{to:"/new_listing"}},[t._v("Create a listing")]):t._e(),t._v(" |\n    "),t.jwt?a("router-link",{attrs:{to:"/logout"}},[t._v("Logout")]):t._e()],1),a("router-view",{on:{changeJwt:function(e){return t.setJwt()}}})],1)},o=[],i={data:function(){return{jwt:null,success:[]}},created:function(){this.jwt=localStorage.jwt,console.log("My jwt is",this.jwt)},methods:{setJwt:function(){this.jwt=localStorage.jwt}}},r=i,l=(a("034f"),a("2877")),c=Object(l["a"])(r,n,o,!1,null,null,null),d=c.exports,u=a("8c4f"),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[a("div",{attrs:{id:"welcome"}},[a("h5",[t._v("Welcome back "+t._s(t.user.first_name)+"!")])]),a("div",{attrs:{id:"map"}}),a("div",{staticClass:"container",attrs:{id:"toolbar"}},[a("h1",[t._v("Listings")]),t._v("\n    "+t._s(t.listings.count)+"\n  ")]),a("div",{staticClass:"container",attrs:{id:"main"}},t._l(t.listings,function(e){return a("div",[a("div",{staticClass:"container",attrs:{id:"listingContainer"}},[a("h5",[t._v(t._s(e.address))]),a("p",[t._v(t._s(e.description))]),a("h5",[t._v(t._s(e.date))]),a("div",{staticClass:"listing-right"},[t._v("\n      "+t._s(e.city)+" "+t._s(e.state)+" "+t._s(e.zip_code)+"\n"),a("button",{attrs:{type:"button","data-toggle":"modal","data-target":"#exampleModalCenter"},on:{click:function(a){return t.viewListing(e.id)}}},[t._v("\n  View Listing\n")])])]),a("div",{staticClass:"modal fade",attrs:{id:"exampleModalCenter",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(0,!0),a("div",{staticClass:"modal-body"},[a("img",{attrs:{src:t.showListing.image_url}}),a("p",[t._v(t._s(t.showListing.description))]),a("h5",[t._v(t._s(t.showListing.address))]),a("h5",[t._v(t._s(t.showListing.city)+","+t._s(t.showListing.state)+" "+t._s(t.showListing.zip_code))])]),t._m(1,!0)])])])])}),0)])},p=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")])])}],f=(a("ac6a"),a("bc3a")),v=a.n(f),g={data:function(){return{listings:[],user:[],showListing:[],monuments:[],map:null,jwt:null,mapboxClient:null}},mounted:function(){var t=this;mapboxgl.accessToken="pk.eyJ1Ijoiam9uZ2xhc3M4MiIsImEiOiJjanVkYmN3b2EwZjlmM3l0Y25kYmtua2VoIn0.7ND4G8md1orasleFIAAyRA";var e=[-88.0934,42.197];this.map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:e,zoom:9});var a=mapboxSdk({accessToken:mapboxgl.accessToken});this.mapboxClient=a,v.a.get("/listings").then(function(e){t.listings=e.data.listings,t.listings.forEach(function(e){t.mapboxClient.geocoding.forwardGeocode({query:e.address,autocomplete:!1}).send().then(function(a){if(a&&a.body&&a.body.features&&a.body.features.length){var s=a.body.features[0];console.log(s),(new mapboxgl.Marker).setLngLat(s.center).addTo(t.map),e.center=s.center}})})})},created:function(){var t=this;v.a.get("/user/current_user").then(function(e){console.log("created",e.data),t.user=e.data})},methods:{viewListing:function(t){var e=this;v.a.get("/listings/"+t).then(function(t){e.showListing=t.data,console.log(e.showListing)})}}},b=g,h=(a("cccb"),Object(l["a"])(b,m,p,!1,null,null,null)),_=h.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"route"},[a("div",{attrs:{id:"map"}}),a("div",{staticClass:"container",attrs:{id:"toolbar"}},[a("div",{attrs:{id:"routeText"}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.route_id,expression:"route_id"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.route_id=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"",disabled:"disabled",selected:"selected"}},[t._v(" Select your route ")]),t._l(t.user_routes,function(e){return a("option",{domProps:{value:e.id}},[t._v("\n            "+t._s(e.date)+"\n         ")])})],2),a("br"),a("br"),t.selectedRoute?a("div",[a("ul",t._l(t.selectedRoute.listings,function(e){return a("li",[a("h4",[t._v(t._s(e.address+" "+e.city+", "+e.state))])])}),0),0===t.selectedRoute.listings.length?a("p",[t._v("No listings")]):t._e()]):t._e(),a("button",{staticClass:"btn btn-primary",attrs:{type:"button","data-toggle":"modal","data-target":"#makeRoute"},on:{click:function(e){return t.startRoute(t.showRoute.listings)}}},[t._v("\n  Start Driving!\n")])])]),a("div",{staticClass:"modal fade",attrs:{id:"makeRoute",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(0),a("div",{staticClass:"modal-body"},t._l(t.steps,function(e){return a("div",[a("ul",[a("li",[t._v(t._s(e))])])])}),0),t._m(1)])])]),a("div",{staticClass:"modal fade",attrs:{id:"exampleModalCenter",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(2),a("div",{staticClass:"modal-body"},[t._v("\n        helo\n        \n        "),a("p",[t._v(t._s(t.showListing.description))]),a("h5",[t._v(t._s(t.showListing.address))]),a("h5",[t._v(t._s(t.showListing.city)+","+t._s(t.showListing.state)+" "+t._s(t.showListing.zip_code))])]),t._m(3)])])]),a("div",{staticClass:"container",attrs:{id:"main"}},t._l(t.listings,function(e){return a("div",[a("div",{staticClass:"container",attrs:{id:"listingContainer"}},[a("div",{staticClass:"listingLeft"},[a("h5",[t._v(t._s(e.address))]),a("h5",[t._v(t._s(e.city+", "+e.state+" "+e.zip_code))]),a("p",[t._v(t._s(e.description))]),a("button",{staticClass:"listingBtn",on:{click:function(a){return t.addToRoute(e.id,t.route_id)}}},[t._v("Add to route")])]),a("div",{staticClass:"listing-right"},[a("br"),a("br"),a("button",{attrs:{type:"button","data-toggle":"modal","data-target":"#exampleModalCenter"},on:{click:function(a){return t.viewListing(e.id)}}},[t._v("\n  View Listing\n")])])])])}),0)])},j=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[t._v("Directions for my trip:")]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")])])}],w=a("fa33"),C=(a("c1df"),{data:function(){return{listings:[],route:[],user:[],user_routes:[],listing_route:"",route_id:"",listing_id:"",myDate:"",showListing:[],showRoute:[],map:null,mapboxClient:null,steps:[]}},computed:{selectedRoute:function(){var t=this,e=this.user_routes.filter(function(e){return e.id===t.route_id})[0];if(e){var a=[-87.623177,41.881832];this.map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:a,zoom:2}),e.listings.forEach(function(e){t.mapboxClient.geocoding.forwardGeocode({query:e.address,autocomplete:!1}).send().then(function(a){if(a&&a.body&&a.body.features&&a.body.features.length){var s=a.body.features[0];console.log(s);var n=new mapboxgl.Marker;n.setLngLat(s.center).addTo(t.map),e.center=s.center}})})}return e}},components:{Datepicker:w["a"]},created:function(){var t=this;v.a.get("/listings").then(function(e){t.listings=e.data.listings}),v.a.get("/user/current_user").then(function(e){t.user=e.data}),v.a.get("/routes").then(function(e){t.user_routes=e.data})},mounted:function(){mapboxgl.accessToken="pk.eyJ1Ijoiam9uZ2xhc3M4MiIsImEiOiJjanVkYmN3b2EwZjlmM3l0Y25kYmtua2VoIn0.7ND4G8md1orasleFIAAyRA";var t=[-87.623177,41.881832];this.map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:t,zoom:3});var e=mapboxSdk({accessToken:mapboxgl.accessToken});this.mapboxClient=e},methods:{createRoute:function(t,e){var a=this,s={date:this.myDate,user:this.user.id};v.a.post("/routes",s).then(function(t){a.route=t.data.route,a.$router.push("/route")})},addToRoute:function(t){var e=this,a={listing_id:t,route_id:this.route_id};v.a.post("/listings_routes",a).then(function(t){e.listing_route=t.data.listing_route})},viewListing:function(t){var e=this;v.a.get("/listings/"+t).then(function(t){e.showListing=t.data,console.log(e.showListing)})},startRoute:function(t){var e=this,a=[];this.selectedRoute.listings.forEach(function(t){a.push("".concat(t.center))}),v.a.get("https://api.mapbox.com/directions/v5/mapbox/driving/".concat(a.join(";"),"?geometries=geojson&steps=true&access_token=").concat("pk.eyJ1Ijoiam9uZ2xhc3M4MiIsImEiOiJjanVkYmN3b2EwZjlmM3l0Y25kYmtua2VoIn0.7ND4G8md1orasleFIAAyRA")).then(function(t){console.log("directions response",t.data);var a=t.data.routes[0],s=a.geometry.coordinates,n={type:"Feature",properties:{},geometry:{type:"LineString",coordinates:s}};e.map.getSource("route")?(console.log("reset route",n),e.map.getSource("route").setData(n)):(console.log("make new request?",n),e.map.addLayer({id:"route",type:"line",source:{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:a.geometry.coordinates}}},layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3887be","line-width":5,"line-opacity":.75}}),console.log("first coordinates",a.geometry.coordinates[0]),e.map.addLayer({id:"point",type:"circle",source:{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Point",coordinates:a.geometry.coordinates[0]}}]}},paint:{"circle-radius":5,"circle-color":"#3887be"}}),console.log("the route is set?",e.map.getSource("route"))),t.data.routes[0].legs.forEach(function(t){return t.steps.forEach(function(t){return e.steps.push(t.maneuver.instruction)})}),e.distance=t.data.routes[0].distance,console.log("COMPLETED",e.distance,e.steps)})},viewRoute:function(t){var e=this;v.a.get("/routes/"+t).then(function(t){e.showRoute=t.data,console.log(e.showRoute)})}}}),x=C,k=(a("041d"),Object(l["a"])(x,y,j,!1,null,null,null)),L=k.exports,D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"login"},[a("div",{staticClass:"container"},[a("form",{on:{submit:function(e){return e.preventDefault(),t.submit()}}},[a("h1",[t._v("Login")]),a("ul",t._l(t.errors,function(e){return a("li",{staticClass:"text-danger"},[t._v(t._s(e))])}),0),a("div",{staticClass:"form-group"},[t._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{type:"email"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),a("div",{staticClass:"form-group"},[t._m(1),a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),a("input",{staticClass:"btn btn-primary",attrs:{type:"submit",value:"Submit"}})])])])},M=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",[a("h3",[t._v("Email:")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",[a("h3",[t._v("Password:")])])}],E={data:function(){return{email:"",password:"",errors:[]}},methods:{submit:function(){var t=this,e={email:this.email,password:this.password};v.a.post("/sessions",e).then(function(e){v.a.defaults.headers.common["Authorization"]="Bearer "+e.data.jwt,localStorage.setItem("jwt",e.data.jwt),t.$emit("changeJwt"),t.$router.push("/"),console.log(user.id)}).catch(function(e){t.errors=["Invalid email or password."],t.email="",t.password=""})}}},R=E,S=(a("d6db"),Object(l["a"])(R,D,M,!1,null,null,null)),I=S.exports,A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"logout"})},z=[],O={created:function(){delete v.a.defaults.headers.common["Authorization"],localStorage.removeItem("jwt"),this.$emit("changeJwt"),this.$router.push("/")}},T=O,N=Object(l["a"])(T,A,z,!1,null,null,null),$=N.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard"},[a("div",{staticClass:"container"},[a("h2",[t._v("Hello "+t._s(t.user.first_name)+"!")])]),a("br"),a("div",{staticClass:"container"},[a("div",{staticClass:"container",attrs:{id:"myRoutes"}},[a("h2",[t._v("My Routes:")]),t._l(t.user.routes,function(e){return a("div",[a("div",{attrs:{id:"eachRoute"}},[t._v("\n        "+t._s(e.date)+"\n\n       ")])])})],2)]),a("br"),a("br"),a("div",{staticClass:"container"},[a("div",{staticClass:"container",attrs:{id:"myListings"}},[a("h2",[t._v("Listings I have created:")]),t._l(t.user.listings,function(e){return a("div",[a("div",{attrs:{id:"eachListing"}},[t._v("\n    \n         "+t._s(e.date)+" "+t._s(e.address)+" "+t._s(e.city)+" "+t._s(e.state)+" "+t._s(e.zip_code)+"\n\n       ")])])})],2)])])},Y=[],Z={data:function(){return{listings:[],route:[],user:[],listing_route:"",route_id:"",listing_id:"",myDate:""}},created:function(){var t=this;v.a.get("/listings").then(function(e){t.listings=e.data.listings}),v.a.get("/user/current_user").then(function(e){console.log("created",e.data),t.user=e.data})},methods:{}},F=Z,J=(a("2b56"),Object(l["a"])(F,P,Y,!1,null,null,null)),V=J.exports,G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"new_listing"},[a("h1",[t._v("Create a new listing")]),a("br"),a("form",{on:{submit:function(e){return e.preventDefault(),t.submit()}}},[a("div",{staticClass:"container"},[a("div",{staticClass:"status",model:{value:t.success,callback:function(e){t.success=e},expression:"success"}},[t._v(t._s(t.success))]),a("div",{staticClass:"container"},[a("div",{staticClass:"form-group"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.newState,expression:"newState"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.newState=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"",disabled:"disabled",selected:"selected"},model:{value:t.newState,callback:function(e){t.newState=e},expression:"newState"}},[t._v(" Select a state")]),t._l(t.states,function(e){return a("option",[t._v("\n            "+t._s(e)+"\n         ")])})],2)]),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.newDate,expression:"newDate"}],attrs:{type:"text",name:"date",placeholder:"Date"},domProps:{value:t.newDate},on:{input:function(e){e.target.composing||(t.newDate=e.target.value)}}}),a("br")]),a("br"),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.newAddress,expression:"newAddress"}],attrs:{type:"text",name:"address",placeholder:"address"},domProps:{value:t.newAddress},on:{input:function(e){e.target.composing||(t.newAddress=e.target.value)}}}),a("br")]),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.newDescription,expression:"newDescription"}],attrs:{type:"text",name:"description",placeholder:"description"},domProps:{value:t.newDescription},on:{input:function(e){e.target.composing||(t.newDescription=e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.newCity,expression:"newCity"}],attrs:{type:"text",name:"City",placeholder:"City"},domProps:{value:t.newCity},on:{input:function(e){e.target.composing||(t.newCity=e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.newZipCode,expression:"newZipCode"}],attrs:{type:"text",name:"Zip Code",placeholder:"Zip Code"},domProps:{value:t.newZipCode},on:{input:function(e){e.target.composing||(t.newZipCode=e.target.value)}}})]),a("br"),a("div",[t._v("\n        Image: "),a("input",{ref:"fileInput",attrs:{type:"file"},on:{change:function(e){return t.setFile(e)}}})]),a("br")]),a("div",{staticClass:"modal fade",attrs:{id:"routeModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(0),a("div",{staticClass:"modal-body"},[a("datepicker",{attrs:{inline:!0},model:{value:t.myDate,callback:function(e){t.myDate=e},expression:"myDate"}}),a("h4",[t._v(t._s(t.myDate))])],1),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"button","data-dismiss":"modal"},model:{value:t.myDate,callback:function(e){t.myDate=e},expression:"myDate"}},[t._v("Select Date")])])])])])]),a("input",{staticClass:"btn btn-primary",attrs:{type:"submit",value:"Create New Listing"}})])])},q=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLongTitle"}},[t._v("Select a date:")]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],U={data:function(){return{states:["AK","AL","AR","AS","AZ","CA","CO","CT","DC","DE","FL","GA","GU","HI","IA","ID","IL","IN","KS","KY","LA","MA","MD","ME","MI","MN","MO","MS","MT","NC","ND","NE","NH","NJ","NM","NV","NY","OH","OK","OR","PA","PR","RI","SC","SD","TN","TX","UT","VA","VI","VT","WA","WI","WV","WY"],newState:"",newAddress:"",newDescription:"",newCity:"",newZipCode:"",newDate:"",errors:[],myDate:""}},components:{Datepicker:w["a"]},created:function(){var t=this;v.a.get("/user/current_user").then(function(e){t.user=e.data})},methods:{setFile:function(t){t.target.files.length>0&&(this.image=t.target.files[0])},submit:function(){var t=this,e=new FormData;e.append("address",this.newAddress),e.append("description",this.newDescription),e.append("city",this.newCity),e.append("state",this.newState),e.append("zip_code",this.newZipCode),e.append("date",this.newDate),e.append("image",this.image),v.a.post("/listings",e).then(function(e){t.address="",t.description="",t.city="",t.state="",t.zip_code="",t.image="",t.date="",t.$refs.fileInput.value=""})}}},H=U,W=(a("20a8"),Object(l["a"])(H,G,q,!1,null,null,null)),B=W.exports,K=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"listingConfirmation"},[a("h1",[t._v("Your listing is confirmed!")]),a("router-link",{attrs:{to:"/"}},[a("button",[t._v("Return to all listings")])])],1)},X=[],Q={},tt=Object(l["a"])(Q,K,X,!1,null,null,null),et=tt.exports,at=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"showListing"},[a("h1",[t._v("Show Listing page")]),a("router-link",{attrs:{to:"/"}},[a("button",[t._v("Return to all listings")])])],1)},st=[],nt={},ot=Object(l["a"])(nt,at,st,!1,null,null,null),it=ot.exports,rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"newRoute"},[a("div",{staticClass:"container",attrs:{id:"toolbar"}},[a("button",{staticClass:"btn btn-primary",attrs:{type:"button","data-toggle":"modal","data-target":"#routeModal"}},[t._v("\n  Pick a date for your route\n")]),a("h3",[t._v("Then")]),a("div",{attrs:{id:"routeText"}},[a("button",[a("router-link",{attrs:{to:"/route"}},[t._v("Choose my listings!")])],1)])]),a("div",{staticClass:"modal fade",attrs:{id:"routeModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalCenterTitle","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-dialog-centered",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(0),a("div",{staticClass:"modal-body"},[a("datepicker",{attrs:{inline:!0},model:{value:t.myDate,callback:function(e){t.myDate=e},expression:"myDate"}}),a("h4",[t._v(t._s(t.myDate))])],1),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Close")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"button","data-dismiss":"modal"},on:{click:function(e){return t.createRoute(t.myDate,t.user)}},model:{value:t.myDate,callback:function(e){t.myDate=e},expression:"myDate"}},[t._v("Create route")])])])])])])},lt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLongTitle"}},[t._v("Pick a date for your route:")]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],ct={data:function(){return{listings:[],route:[],user:[],user_routes:[],listing_route:"",route_id:"",listing_id:"",myDate:"",showListing:[],showRoute:[],map:null,mapboxClient:null,steps:[]}},computed:{selectedRoute:function(){var t=this,e=this.user_routes.filter(function(e){return e.id===t.route_id})[0];if(e){var a=[-87.623177,41.881832];this.map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:a,zoom:2}),e.listings.forEach(function(e){t.mapboxClient.geocoding.forwardGeocode({query:e.address,autocomplete:!1}).send().then(function(a){if(a&&a.body&&a.body.features&&a.body.features.length){var s=a.body.features[0];console.log(s);var n=new mapboxgl.Marker;n.setLngLat(s.center).addTo(t.map),e.center=s.center}})})}return e}},components:{Datepicker:w["a"]},created:function(){var t=this;v.a.get("/listings").then(function(e){t.listings=e.data.listings}),v.a.get("/user/current_user").then(function(e){t.user=e.data}),v.a.get("/routes").then(function(e){t.user_routes=e.data})},mounted:function(){mapboxgl.accessToken="pk.eyJ1Ijoiam9uZ2xhc3M4MiIsImEiOiJjanVkYmN3b2EwZjlmM3l0Y25kYmtua2VoIn0.7ND4G8md1orasleFIAAyRA";var t=[-87.623177,41.881832];this.map=new mapboxgl.Map({container:"map",style:"mapbox://styles/mapbox/streets-v11",center:t,zoom:11});var e=mapboxSdk({accessToken:mapboxgl.accessToken});this.mapboxClient=e},methods:{createRoute:function(t,e){var a=this,s={date:this.myDate,user:this.user.id};v.a.post("/routes",s).then(function(t){a.route=t.data,a.$router.push("/newroute")})},addToRoute:function(t,e){var a=this,s={listing_id:t,route_id:this.route.id};console.log(s),v.a.post("/listings_routes",s).then(function(t){a.listing_route=t.data.listing_route})},viewListing:function(t){var e=this;v.a.get("/listings/"+t).then(function(t){e.showListing=t.data,console.log(e.showListing)})},startRoute:function(t){var e=this,a=[];this.selectedRoute.listings.forEach(function(t){a.push("".concat(t.center))}),v.a.get("https://api.mapbox.com/directions/v5/mapbox/driving/".concat(a.join(";"),"?geometries=geojson&steps=true&access_token=").concat("pk.eyJ1Ijoiam9uZ2xhc3M4MiIsImEiOiJjanVkYmN3b2EwZjlmM3l0Y25kYmtua2VoIn0.7ND4G8md1orasleFIAAyRA")).then(function(t){console.log("directions response",t.data);var a=t.data.routes[0],s=a.geometry.coordinates,n={type:"Feature",properties:{},geometry:{type:"LineString",coordinates:s}};e.map.getSource("route")?(console.log("reset route",n),e.map.getSource("route").setData(n)):(console.log("make new request?",n),e.map.addLayer({id:"route",type:"line",source:{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:a.geometry.coordinates}}},layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3887be","line-width":5,"line-opacity":.75}}),console.log("first coordinates",a.geometry.coordinates[0]),e.map.addLayer({id:"point",type:"circle",source:{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"Point",coordinates:a.geometry.coordinates[0]}}]}},paint:{"circle-radius":10,"circle-color":"#3887be"}}),console.log("the route is set?",e.map.getSource("route"))),t.data.routes[0].legs.forEach(function(t){return t.steps.forEach(function(t){return e.steps.push(t.maneuver.instruction)})}),e.distance=t.data.routes[0].distance,console.log("COMPLETED",e.distance,e.steps)})},viewRoute:function(t){var e=this;v.a.get("/routes/"+t).then(function(t){e.showRoute=t.data,console.log(e.showRoute)})}}},dt=ct,ut=(a("978e"),Object(l["a"])(dt,rt,lt,!1,null,null,null)),mt=ut.exports,pt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"createRoute"},[a("div",{staticClass:"container",attrs:{id:"routeButtons"}},[a("h1",[t._v("Create a new route or use an existing route?")]),a("button",[a("router-link",{attrs:{to:"/newroute"}},[t._v("Start a new route")])],1),a("br"),a("br"),a("button",[a("router-link",{attrs:{to:"/route"}},[t._v("Use an existing route")])],1)])])},ft=[],vt=(a("100f"),{}),gt=Object(l["a"])(vt,pt,ft,!1,null,null,null),bt=gt.exports;s["a"].use(u["a"]);var ht=new u["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:_},{path:"/route",name:"route",component:L},{path:"/login",name:"login",component:I},{path:"/logout",name:"logout",component:$},{path:"/dashboard",name:"dashboard",component:V},{path:"/new_listing",name:"new_listing",component:B},{path:"/listingConfirmation",name:"listingConfirmation",component:et},{path:"/showListing",name:"showListing",component:it},{path:"/newroute",name:"newRoute",component:mt},{path:"/createroute",name:"createRoute",component:bt}]});v.a.defaults.baseURL="/";var _t=localStorage.getItem("jwt");_t&&(v.a.defaults.headers.common["Authorization"]="Bearer "+_t),s["a"].config.productionTip=!1,new s["a"]({router:ht,render:function(t){return t(d)}}).$mount("#app")},"64a9":function(t,e,a){},7013:function(t,e,a){},"978e":function(t,e,a){"use strict";var s=a("49cd"),n=a.n(s);n.a},a9e7:function(t,e,a){},bd3b:function(t,e,a){},cccb:function(t,e,a){"use strict";var s=a("d563"),n=a.n(s);n.a},d563:function(t,e,a){},d6db:function(t,e,a){"use strict";var s=a("a9e7"),n=a.n(s);n.a}});
//# sourceMappingURL=app.476fbe2e.js.map